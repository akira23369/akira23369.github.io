---
title: 17.父子关系
date: 2025-02-19 16:56:46
toc: true
categories:
  - 游戏引擎
  - unity
  - unity入门
  - unity入门基础知识

tags:
  - 游戏引擎
  - unity
  - unity入门
  - unity入门基础知识
  - Unity重要组件和API
---
# 获取和设置父对象
```csharp
// 获取父对象
print(this.transform.parent);

// 断绝父子关系
this.transform.parent = null;

 // 认父亲      // 也会顺带把孙子的爷爷也换了
this.transform.parent = GameObject.Find("obj").transform;


// 下面这种认父亲的方法    特殊一些

// 第二个参数为true 则不会改掉物体本来的世界坐标位置,大小什么的
//          为false, 则会把原来Inspector面板上的数字原封不动的赋值到新的Inspector窗口上，则会用自己的transform中的数值
// 子对象世界坐标 = 父对象世界坐标 × 子对象局部坐标（当 worldPositionStays = false 时）。
// 动态创建ui时常用
this.transform.SetParent(GameObject.Find("obj").transform, false);      
```

# 抛妻弃子
```csharp
// 和自己所有儿子断绝关系,  不会断掉儿子和孙子的
this.transform.DetachChildren();
```

# 获取子对象及其操作
```csharp
// 根据名字查找儿子对象       (不可以查找孙子, 可以找到失活的儿子，GameObject的find不能查找失活的对象 )
print(this.transform.Find("Capsule"));
// 查找Father的儿子Son
print(this.transform.Find("Father/Son"));

// 儿子数量
print(this.transform.childCount);
// 遍历
for (int i = 0; i < this.transform.childCount; i++)
    print(this.transform.GetChild(i));
	
// 判断是不是自己是不是另一个对象的儿子
bool v = this.transform.IsChildOf(transform.parent);

// 设置自己作为儿子编号
this.transform.SetSiblingIndex(0);

// 得到自己作为儿子的编号
print(this.transform.GetSiblingIndex());
```


# 练习
 请为Transform写一个拓展方法，可以将它的子对象按名字的长短进行排序改变他们的顺序，名字短的在前面，名字长的在后面
```csharp
public static class TransformExtensions
{
    public static void SortChildrenByNameLength(this Transform obj)
    {
        //var children = obj.Cast<Transform>().ToList();
        //children = children.OrderBy(child => child.name.Length).ToList();

        //for (int i = 0; i < children.Count; i++)
        //{
        //    children[i].SetSiblingIndex(i);
        //}

        List<Transform> list = new List<Transform>();
        for (int i = 0; i < obj.childCount; i++)
        {
            list.Add(obj.GetChild(i));
        }

        //这是根据 名字长短进行排序 利用的 是list的排序 传个函数进去
        list.Sort((a, b) => a.transform.name.Length - b.transform.name.Length);

        //根据 list中的排序结果 重新设置每一个对象的 索引编号
        for (int i = 0; i < list.Count; i++)
        {
            list[i].SetSiblingIndex(i);
        }
    }
}

```

请为Transform写一个拓展方法，传入一个名字查找子对象，即使是子对象的子对象也能查找到
```csharp
public static class TransformExtensions
{
    public static Transform CustomFind(this Transform obj, string name)
    {
        Transform res = null;

        res = obj.Find(name);
        if (res != null) return res;

        for (int i = 0; i < obj.childCount; i++)
        {
            res = obj.GetChild(i).CustomFind(name);
            if (res != null) return res;
        }

        return res;
    }
}
```