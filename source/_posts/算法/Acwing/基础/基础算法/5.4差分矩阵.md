---
title: 5.4差分矩阵
date: 2000-01-01 00:00:00
toc: false
categories:
  - 算法
  - Acwing
  - 基础
  - 基础算法

tags:
  - 算法
  - Acwing
  - 基础
  - 基础算法
  - 模板题
  - 差分
---

[798. 差分矩阵 - AcWing题库](https://www.acwing.com/problem/content/800/)

### 题目描述
输入一个 $n$ 行 $m$ 列的整数矩阵，再输入 $q$ 个操作，每个操作包含五个整数 $x_1, y_1, x_2, y_2, c$，其中 $(x_1, y_1)$ 和 $(x_2, y_2)$ 表示一个子矩阵的左上角坐标和右下角坐标。

每个操作都要将选中的子矩阵中的每个元素的值加上 $c$。

请你将进行完所有操作后的矩阵输出。

#### 输入格式

第一行包含整数 $n,m,q$。

接下来 $n$ 行，每行包含 $m$ 个整数，表示整数矩阵。

接下来 $q$ 行，每行包含 $5$ 个整数 $x_1, y_1, x_2, y_2, c$，表示一个操作。

#### 输出格式

共 $n$ 行，每行 $m$ 个整数，表示所有操作进行完毕后的最终矩阵。

#### 数据范围

$1 \le n,m \le 1000$,  
$1 \le q \le 100000$,  
$1 \le x_1 \le x_2 \le n$,  
$1 \le y_1 \le y_2 \le m$,  
$-1000 \le c \le 1000$,  
$-1000 \le 矩阵内元素的值 \le 1000$

#### 输入样例：

```
3 4 3
1 2 2 1
3 2 2 1
1 1 1 1
1 1 2 2 1
1 3 2 3 2
3 1 3 4 1
```

#### 输出样例：

```
2 3 4 1
4 3 4 1
2 2 2 2
```

---
### 算法


```cpp
#include<iostream>
#include<algorithm>
using namespace std;
const int N = 1010;

int a[N][N], b[N][N];
//给以(x1, y1)为左上角，(x2, y2)为右下角的子矩阵中的所有元素加上c：
//S[x1, y1] += c, S[x2 + 1, y1] -= c, S[x1, y2 + 1] -= c, S[x2 + 1, y2 + 1] += c

int main()
{
    int n, m, q;
    cin >> n >> m >> q;
    for (int i = 1;i <= n;i++)
    {
        for (int j = 1;j <= m;j++)
        {
            cin >> a[i][j];
            b[i][j] = a[i][j] - a[i - 1][j] - a[i][j - 1] + a[i - 1][j - 1];    //构造差分矩阵
        }
    }
    while (q--)
    {
        int x1, x2, y1, y2, c;
        cin >> x1 >> y1 >> x2 >> y2 >> c;
        b[x1][y1] += c, b[x1][y2 + 1] -= c;b[x2 + 1][y1] -= c, b[x2 + 1][y2 + 1] += c;
    }
    for (int i = 1;i <= n;i++)
    {
        for (int j = 1;j <= m;j++)
        {
            a[i][j] = b[i][j] + a[i - 1][j] + a[i][j - 1] - a[i - 1][j - 1];    //求前缀和
            cout << a[i][j] << " ";
        }
        cout << endl;
    }
    return 0;
}
```